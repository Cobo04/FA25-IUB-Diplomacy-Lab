{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="dashboardContainer">

    <div class="sidebar">
        <div class="sidebarUpperContainer">
            <div class="sidebarTitle"><strong>SPACE</strong></div>
        </div>

        <div class="sidebarLowerContainer">
            <div class="sidebarSectionTitle">Visualization</div>
            <a href="{{ url_for('dashboard') }}" class="sidebarLink">Dashboard</a>
            <a href="{{ url_for('map') }}" class="sidebarLink">Interactive Map</a>
            <a href="{{ url_for('link_analysis') }}" class="sidebarLink">Link Analysis</a>
            <!-- <a href="{{ url_for('comparative_analysis') }}" class="sidebarLink">Comparative Analysis</a> -->

            <div class="sidebarSectionTitle">SPACE Score</div>
            <a href="{{ url_for('companies') }}" class="sidebarLink">Company Database</a>
            <a href="{{ url_for('add_company') }}" class="sidebarLink">Add Company</a>
            <a href="{{ url_for('select_company') }}" class="sidebarLink">Generate Score</a>

            <!-- THIS IS TBD MAKE SURE TO ACTUALLY DO THIS LOL -->

            <!-- <div class="sidebarSectionTitle">Satellite Visualization</div>
            <a href="" class="sidebarLink">Orbitting Technology</a>
            <a href="" class="sidebarLink">Satellite Database</a>
            <a href="" class="sidebarLink">Add Satellite</a> -->

            <div class="sidebarSectionTitle">Resources</div>
            <a href="https://github.com/Cobo04/FA25-IUB-Diplomacy-Lab" class="sidebarLink">Documentation</a>
            <a href="{{ url_for('documents') }}" class="sidebarLink">Research Reports</a>

            <div class="sidebarSectionTitle">Miscellanious</div>
            <a href="" class="sidebarLink">Settings</a>
            <a href="{{ url_for('admin') }}" class="sidebarLink">Administrator Panel</a>
            <!-- <a href="{{ url_for('server_stats') }}" class="sidebarLink">cohen's nerd stats</a> -->
            <a href="{{ url_for('render_index') }}" class="sidebarLink">Logout</a>
        </div>
    </div>

    <div class="mainContent">

        <div class="mainContentUpperContainer">

            <div class="mainContentTitle">Dashboard</div>


            <div class="mainContentSearchContainer" style="position: relative;">
                <!-- Dashboard search bar with live dropdown results -->
                <input type="text" class="mainContentSearchBar" id="dashboard-search" placeholder="Search..." autocomplete="off">
                <div id="search-results" class="searchContentContainer"></div>
            </div>

            <script>

            // Search data with links
            const searchData = [
                { label: 'Add Company', url: "{{ url_for('add_company') }}" },
                { label: 'Company Database', url: "{{ url_for('companies') }}" },
                { label: 'Generate Report', url: "{{ url_for('select_company') }}" },
                { label: 'Logout', url: "{{ url_for('render_index') }}" },
                { label: 'Dashboard', url: "{{ url_for('dashboard') }}" },
                { label: 'Comparative Analysis', url: "#" },
                { label: 'Link Analysis', url: "{{ url_for('link_analysis') }}" },
                { label: 'Documentation', url: "{{ url_for('documents') }}" },
                { label: 'Interactive Map', url: "{{ url_for('map') }}" },
                { label: 'Admin Panel', url: "{{ url_for('admin') }}" }
            ];

            const searchInput = document.getElementById('dashboard-search');
            const resultsDiv = document.getElementById('search-results');

            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                if (!query) {
                    resultsDiv.style.display = 'none';
                    resultsDiv.innerHTML = '';
                    return;
                }
                const matches = searchData.filter(item => item.label.toLowerCase().includes(query));
                if (matches.length === 0) {
                    resultsDiv.style.display = 'none';
                    resultsDiv.innerHTML = '';
                    return;
                }
                resultsDiv.innerHTML = matches.map(item => `<a href='${item.url}' class='search-result-item' style='padding: 0.5em; cursor: pointer; display: block; color: inherit; text-decoration: none;'>${item.label}</a>`).join('');
                resultsDiv.style.display = 'block';
            });

            // Hide results when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !resultsDiv.contains(e.target)) {
                    resultsDiv.style.display = 'none';
                }
            });

            // Optionally: handle click on result (for now, just fill input)
            resultsDiv.addEventListener('click', function(e) {
                if (e.target.classList.contains('search-result-item')) {
                    // Let the anchor tag handle navigation
                    resultsDiv.style.display = 'none';
                }
            });
            </script>

            <div class="mainContentButtonContainer">
                <button class="mainContentButton"><i class="bi bi-bell"></i></button>
                <button class="mainContentButton"><i class="bi bi-grid-3x3-gap"></i></button>
                <button class="mainContentButton"><i class="bi bi-info-circle"></i></button>
            </div>

        </div>

        {%block dashboard_content %}{% endblock %}
        
    </div>

</div>

{% endblock %}